{
    "module": "webengine",
    "depends": [
        "core-private",
        "gui-private",
        "printsupport"
    ],

    "commandline": {
        "options": {
            "alsa": "boolean",
            "embedded": "boolean",
            "webengine-icu": { "type": "enum", "name": "system-icu", "values": { "system": "yes", "qt": "no" } },
            "ffmpeg": { "type": "enum", "name": "system-ffmpeg", "values": { "system": "yes", "qt": "no" } },
            "opus": { "type": "enum", "name": "system-opus", "values": { "system": "yes", "qt": "no" } },
            "webp": { "type": "enum", "name": "system-libwebp", "values": { "system": "yes", "qt": "no" } },
            "pepper-plugins": "boolean",
            "printing-and-pdf": "boolean",
            "proprietary-codecs": "boolean",
            "pulseaudio": "boolean",
            "spellchecker": "boolean",
            "native-spellchecker": "boolean",
            "webrtc": "boolean",
            "geolocation" : "boolean"
        }
    },

    "libraries": {
        "dbus": {
            "label": "d-bus",
            "sources": [
                { "type": "pkgConfig", "args": "dbus-1" }
            ]
        },
        "fontconfig": {
            "label": "fontconfig",
            "sources": [
                { "type": "pkgConfig", "args": "fontconfig" }
            ]
        },
        "libdrm": {
            "label": "libdrm",
            "sources": [
                { "type": "pkgConfig", "args": "libdrm" }
            ]
        },
        "xcomposite": {
            "label": "xcomposite",
            "sources": [
                { "type": "pkgConfig", "args": "xcomposite" }
            ]
        },
        "xcursor": {
            "label": "xcursor",
            "sources": [
                { "type": "pkgConfig", "args": "xcursor" }
            ]
        },
        "xi": {
            "label": "xi",
            "sources": [
                { "type": "pkgConfig", "args": "xi" }
            ]
        },
        "xrandr": {
            "label": "xrandr",
            "sources": [
                { "type": "pkgConfig", "args": "xrandr" }
            ]
        },
        "xtst": {
            "label": "xtst",
            "sources": [
                { "type": "pkgConfig", "args": "xtst" }
            ]
        },
        "harfbuzz": {
            "label": "harfbuzz >= 1.4.2",
            "sources": [
                { "type": "pkgConfig", "args": "harfbuzz >= 1.4.2" }
            ]
        },
        "glib": {
            "label": "glib-2.0 >= 2.32.0",
            "sources": [
                { "type": "pkgConfig", "args": "glib-2.0 >= 2.32.0" }
            ]
        },
        "zlib": {
            "label": "zlib",
            "sources": [
                { "type": "pkgConfig", "args": "zlib" }
            ]
        },
        "minizip": {
            "label": "minizip",
            "sources": [
                { "type": "pkgConfig", "args": "minizip" }
            ]
        },
        "libevent": {
            "label": "libevent",
            "sources": [
                { "type": "pkgConfig", "args": "libevent" }
            ]
        },
        "libxml2": {
            "label": "libxml2 and libxslt",
            "sources": [
                { "type": "pkgConfig", "args": "libxml-2.0 libxslt" }
            ]
        },
        "jsoncpp": {
            "label": "jsoncpp",
            "sources": [
                { "type": "pkgConfig", "args": "jsoncpp" }
            ]
        },
        "protobuf": {
            "label": "protobuf",
            "sources": [
                { "type": "pkgConfig", "args": "protobuf" }
            ]
        },
        "pulseaudio": {
            "label": "pulseaudio >= 0.9.10",
            "sources": [
                { "type": "pkgConfig", "args": "libpulse >= 0.9.10 libpulse-mainloop-glib" }
            ]
        },
        "icu": {
            "label": "icu >= 53",
            "sources": [
                { "type": "pkgConfig", "args": "icu-uc >= 53 icu-i18n >= 53" }
            ]
        },
        "ffmpeg": {
            "label": "libavcodec libavformat libavutil",
            "sources": [
                { "type": "pkgConfig", "args": "libavcodec libavformat libavutil" }
            ]
        },
        "opus": {
            "label": "opus",
            "sources": [
                { "type": "pkgConfig", "args": "opus" }
            ]
        },
        "webp": {
            "label": "libwebp, libwebpmux and libwebpdemux",
            "sources": [
                { "type": "pkgConfig", "args": "libwebp libwebpmux libwebpdemux" }
            ]
        },
        "nss": {
            "label": "nss",
            "sources": [
                { "type": "pkgConfig", "args": "nss" }
            ]
        },
        "png": {
            "label": "libpng >= 1.6.0",
            "sources": [
                { "type": "pkgConfig", "args": "libpng >= 1.6.0" }
            ]
        }
    },

    "tests" : {
        "alsa": {
            "label": "alsa",
            "test": "alsa",
            "type": "compile"
        },
        "khr": {
            "label": "khr",
            "test": "khr",
            "type": "compile"
        },
        "libvpx": {
            "label": "libvpx",
            "test": "libvpx",
            "type": "compile"
        },
        "snappy": {
            "label": "snappy",
            "test": "snappy",
            "type": "compile"
        },
        "srtp": {
            "label": "srtp",
            "test": "srtp",
            "type": "compile"
        },
        "winversion": {
            "label": "winversion",
            "test": "winversion",
            "type": "compile"
        },
        "protoc": {
            "label": "protoc",
            "type": "detectProtoc"
        },
        "python2": {
            "label": "python2",
            "type": "detectPython2",
            "log": "location"
        },
        "gperf": {
            "label": "gperf",
            "type": "detectGperf"
        },
        "bison": {
            "label": "bison",
            "type": "detectBison"
        },
        "flex": {
            "label": "flex",
            "type": "detectFlex"
        },
        "ninja": {
            "label": "system ninja",
            "type": "detectNinja"
        },
        "gn": {
            "label": "system gn",
            "type": "detectGn"
        },
        "embedded": {
            "label": "embedded",
            "type": "embedded"
        },
        "re2": {
            "label": "re2",
            "test": "re2",
            "type": "compile"
        },
        "glibc": {
            "label": "glibc > 2.16",
            "type": "detectGlibc"
        },
        "icuuc": {
            "label" : "libxml2 configured with icuuc",
            "type": "detectIcuuc"
        },
        "sanitizer": {
            "label" : "sanitizer support",
            "type": "isSanitizerSupported"
        }
    },

    "features": {
        "system-fontconfig": {
            "label": "fontconfig",
            "condition": "libs.fontconfig",
            "output": [ "privateFeature" ]
        },
        "system-dbus": {
            "label": "dbus",
            "condition": "libs.dbus",
            "output": [ "privateFeature" ]
        },
        "system-libdrm": {
            "label": "libdrm",
            "condition": "libs.libdrm",
            "output": [ "privateFeature" ]
        },
        "system-xcomposite": {
            "label": "xcomposite",
            "condition": "libs.xcomposite",
            "output": [ "privateFeature" ]
        },
        "system-xcursor": {
            "label": "xcursor",
            "condition": "libs.xcursor",
            "output": [ "privateFeature" ]
        },
        "system-xi": {
            "label": "xi",
            "condition": "libs.xi",
            "output": [ "privateFeature" ]
        },
        "system-xrandr": {
            "label": "xrandr",
            "condition": "libs.xrandr",
            "output": [ "privateFeature" ]
        },
        "system-xtst": {
            "label": "xtst",
            "condition": "libs.xtst",
            "output": [ "privateFeature" ]
        },
        "webengine-system-harfbuzz": {
            "label": "harfbuzz",
            "condition": "config.unix && features.system-harfbuzz && libs.harfbuzz",
            "output": [ "privateFeature" ]
        },
        "system-glib" : {
            "label": "glib",
            "condition": "config.unix && libs.glib",
            "output": [ "privateFeature" ]
        },
        "system-minizip" : {
            "label": "minizip",
            "condition": "config.unix && libs.minizip",
            "output": [ "privateFeature" ]
        },
        "webengine-system-zlib" : {
            "label": "zlib",
            "condition": "config.unix && features.system-zlib && libs.zlib",
            "output": [ "privateFeature" ]
        },
        "system-libevent" : {
            "label": "libevent",
            "condition": "config.unix && libs.libevent",
            "output": [ "privateFeature" ]
        },
        "system-jsoncpp" : {
            "label": "jsoncpp",
            "condition": "config.unix && libs.jsoncpp",
            "output": [ "privateFeature" ]
        },
        "system-protobuf" : {
            "label": "protobuf",
            "condition": "config.unix && libs.protobuf && tests.protoc",
            "output": [ "privateFeature" ]
        },
        "webengine-system-png" : {
            "label": "png",
            "condition": "config.unix && features.system-png && libs.png",
            "output": [ "privateFeature" ]
        },
        "python2": {
            "label": "python2",
            "condition": "tests.python2",
            "output": [
                "privateFeature",
                { "type": "varAssign", "name": "QMAKE_PYTHON2", "value": "tests.python2.location" }
            ]
        },
        "gperf": {
            "label": "gperf",
            "condition": "tests.gperf",
            "output": [ "privateFeature" ]
        },
        "bison": {
            "label": "bison",
            "condition": "tests.bison",
            "output": [ "privateFeature" ]
        },
        "flex": {
            "label": "flex",
            "condition": "tests.flex",
            "output": [ "privateFeature" ]
        },
        "embedded": {
            "label": "Embedded build",
            "purpose": "Enables the embedded build configuration.",
            "section": "WebEngine",
            "condition": "config.unix",
            "autoDetect": "tests.embedded",
            "output": [ "privateFeature" ]
        },
        "alsa": {
            "label": "Use ALSA",
            "condition": "config.unix && tests.alsa",
            "output": [ "privateFeature" ]
        },
        "system-khr" : {
            "label": "khr",
            "condition": "config.unix && tests.khr",
            "output": [ "privateFeature" ]
        },
        "system-libvpx" : {
            "label": "libvpx",
            "condition": "config.unix && tests.libvpx",
            "output": [ "privateFeature" ]
        },
        "system-snappy" : {
            "label": "snappy",
            "condition": "config.unix && tests.snappy",
            "output": [ "privateFeature" ]
        },
        "system-libsrtp" : {
            "label": "libsrtp",
            "condition": "config.unix && tests.srtp",
            "output": [ "privateFeature" ]
        },
        "system-libxml2" : {
            "label": "libxml2",
            "condition": "config.unix && tests.srtp",
            "output": [ "privateFeature" ]
        },
        "winversion" : {
            "label": "winversion",
            "condition": "config.win32 && tests.winversion",
            "output": [ "privateFeature" ]
        },
        "geolocation": {
            "label": "Geolocation",
            "condition": "module.positioning",
            "output": [ "privateFeature" ]
        },
        "pulseaudio": {
            "label": "Use PulseAudio",
            "autoDetect": "config.unix",
            "condition": "libs.pulseaudio",
            "output": [ "privateFeature" ]
        },
        "pepper-plugins": {
            "label": "Pepper Plugins",
            "purpose": "Enables use of Pepper Flash and Widevine plugins.",
            "section": "WebEngine",
            "autoDetect": "!features.embedded",
            "output": [ "privateFeature" ]
        },
        "printing-and-pdf": {
            "label": "Printing and PDF",
            "purpose": "Provides printing and output to PDF.",
            "section": "WebEngine",
            "condition": "module.printsupport && features.printer",
            "autoDetect": "!features.embedded",
            "output": [ "privateFeature" ]
        },
        "proprietary-codecs": {
            "label": "Proprietary Codecs",
            "purpose": "Enables the use of proprietary codecs such as h.264/h.265 and MP3.",
            "section": "WebEngine",
            "autoDetect": false,
            "output": [ "privateFeature" ]
        },
        "spellchecker": {
            "label": "Spellchecker",
            "purpose": "Provides a spellchecker.",
            "section": "WebEngine",
            "output": [ "publicFeature" ]
        },
        "native-spellchecker": {
            "label": "Native Spellchecker",
            "purpose": "Provides a native spellchecker.",
            "section": "WebEngine",
            "autoDetect": false,
            "condition": "config.macos && features.spellchecker",
            "output": [ "publicFeature" ]
        },
        "ui-delegates": {
            "label": "UI Delegates",
            "output": [ "privateFeature" ]
        },
        "testsupport": {
            "label": "Test Support",
            "autoDetect": "features.private_tests || call.isTestsInBuildParts",
            "output": [ "privateFeature" ]
        },
        "webrtc": {
            "label": "WebRTC",
            "purpose": "Provides WebRTC support.",
            "section": "WebEngine",
            "autoDetect": "!features.embedded",
            "output": [ "privateFeature" ]
        },
        "system-nss": {
            "label": "nss",
            "condition": "config.unix && !config.darwin && libs.nss",
            "output": [ "privateFeature" ]
        },
        "system-libwebp": {
            "label": "libwebp, libwebpmux and libwebpdemux",
            "autoDetect": "config.unix",
            "condition": "libs.webp",
            "output": [ "privateFeature" ]
        },
        "system-opus": {
            "label": "opus",
            "autoDetect": "config.unix",
            "condition": "libs.opus",
            "output": [ "privateFeature" ]
        },
        "system-ffmpeg": {
            "label": "ffmpeg",
            "autoDetect": false,
            "condition": "libs.ffmpeg && features.system-opus && features.system-libwebp",
            "output": [ "privateFeature" ]
        },
        "system-icu": {
            "label": "icu",
            "autoDetect": false,
            "condition": "libs.icu",
            "output": [ "privateFeature" ]
        },
        "system-re2": {
            "label": "re2",
            "autoDetect": "config.unix",
            "condition": "tests.re2",
            "output": [ "privateFeature" ]
        },
        "system-ninja": {
            "label": "Use System Ninja",
            "condition": "tests.ninja",
            "output": [ "privateFeature" ]
        },
        "system-gn": {
            "label": "Use System Gn",
            "autoDetect": false,
            "condition": "tests.gn",
            "output": [ "privateFeature" ]
        },
        "system-glibc": {
            "label": "glibc",
            "condition": "config.linux && tests.glibc",
            "output": [ "privateFeature" ]
        },
        "system-libxml2": {
            "label": "libxml2 and libxslt",
            "condition": "config.unix && libs.libxml2 && tests.icuuc",
            "output": [ "privateFeature" ]
        },
        "webengine-sanitizer" : {
            "label": "Sanitizer ",
            "autoDetect": "config.sanitizer && tests.sanitizer",
            "condition": "config.sanitizer",
            "output": [ "privateFeature" ]
        }
    },

    "report": [
        {
            "type": "warning",
            "condition": "!features.python2",
            "message": "Python version 2 (2.7.5 or later) is required to build QtWebEngine."
        },
        {
            "type": "warning",
            "condition": "!features.gperf",
            "message": "gperf is required to build QtWebEngine."
        },
        {
            "type": "warning",
            "condition": "!features.bison",
            "message": "bison is required to build QtWebEngine."
        },
        {
            "type": "warning",
            "condition": "!features.flex",
            "message": "flex is required to build QtWebEngine."
        }
    ],

    "summary": [
        {
            "section": "Qt WebEngine",
            "entries": [
                "embedded",
                "pepper-plugins",
                "printing-and-pdf",
                "proprietary-codecs",
                "spellchecker",
                "native-spellchecker",
                "webrtc",
                "system-ninja",
                "geolocation",
                {
                    "type": "feature",
                    "args": "alsa",
                    "condition": "config.unix"
                },
                {
                    "type": "feature",
                    "args": "pulseaudio",
                    "condition": "config.unix"
                },
                {
                   "section": "Optional system libraries used",
                   "condition": "config.unix",
                   "entries": [
                        "system-re2",
                        "system-icu",
                        "system-libwebp",
                        "system-opus",
                        "system-ffmpeg",
                        "system-libvpx",
                        "system-snappy",
                        "system-libsrtp",
                        "system-glib",
                        "webengine-system-zlib",
                        "system-minizip",
                        "system-libevent",
                        "system-jsoncpp",
                        "system-protobuf",
                        "system-libxml2",
                        "webengine-system-png",
                        "webengine-system-harfbuzz"
                    ]
                },
                {
                   "section": "Required system libraries",
                   "condition": "config.unix && !config.macos",
                   "entries": [
                        "system-fontconfig",
                        "system-dbus",
                        "system-nss",
                        "system-khr",
                        "system-glibc"
                    ]
                },
                {
                   "section": "Required system libraries for qpa-xcb",
                   "condition": "config.unix && !config.macos",
                   "entries": [
                        "system-libdrm",
                        "system-xcomposite",
                        "system-xcursor",
                        "system-xi",
                        "system-xrandr",
                        "system-xtst"
                    ]
                }
            ]
        }
    ]
}
